<ion-content [fullscreen]="true" class="confessions-content">
  <div class="confessions-container">
    <!-- Header Section -->
    <div class="header-section">
      <ion-button 
        fill="clear" 
        class="back-btn"
        (click)="goBack()">
        <ion-icon name="chevron-back" slot="icon-only"></ion-icon>
      </ion-button>
      
      <div class="header-content">
        <h1 class="page-title">Confiss√µes</h1>
        <p class="page-subtitle">Escreva suas confiss√µes an√¥nimas</p>
      </div>
    </div>

    <!-- Start Game Button (when ready) -->
    <div class="start-game-section" *ngIf="canStartGame()">
      <ion-button 
        expand="full"
        class="start-game-btn"
        (click)="startGame()">
        <ion-icon name="rocket" slot="start"></ion-icon>
        Come√ßar Jogo!
        <ion-icon name="arrow-forward" slot="end"></ion-icon>
      </ion-button>
    </div>

    <!-- Player Progress Bar -->
    <div class="progress-section">
      <div class="players-progress">
        <div 
          *ngFor="let player of players; let i = index"
          class="player-dot"
          [class.current]="i === currentPlayerIndex"
          [class.completed]="isPlayerComplete(player.id)"
          (click)="selectPlayer(i)">
          <span class="player-avatar">{{ player.avatar }}</span>
          <div class="completion-indicator" *ngIf="isPlayerComplete(player.id)">
            <ion-icon name="checkmark"></ion-icon>
          </div>
        </div>
      </div>
      
      <div class="progress-text">
        <span class="current-player">{{ currentPlayer?.name }}</span>
        <span class="progress-count">{{ currentPlayerConfessions.length }}/{{ minConfessions }}</span>
      </div>
    </div>

    <!-- Confession Form -->
    <div class="confession-form-section">
      <div class="category-selector">
        <label class="category-label">Categoria</label>
        <select 
          class="category-select"
          [(ngModel)]="selectedCategory"
          (change)="onCategoryChange(getSelectValue($event))">
          <option value="" disabled>Escolha uma categoria</option>
          <option *ngFor="let option of categoryOptions" [value]="option.value">
            {{ option.emoji }} {{ option.label }}
          </option>
        </select>
      </div>
      
      <div class="confession-input-container">
        <textarea 
          class="confession-textarea"
          [(ngModel)]="confessionText"
          placeholder="Digite sua confiss√£o..."
          maxlength="200"
          rows="4"></textarea>
        <div class="char-counter">{{ confessionText.length || 0 }}/200</div>
      </div>
      
      <!-- Suggestions -->
      <div class="suggestions-section" *ngIf="suggestions.length > 0 && !confessionText">
        <h4 class="suggestions-title">üí° Sugest√µes</h4>
        <div class="suggestions-grid">
          <button 
            *ngFor="let suggestion of suggestions"
            class="suggestion-chip"
            (click)="useSuggestion(suggestion)">
            {{ suggestion }}
          </button>
        </div>
      </div>
      
      <ion-button 
        expand="full"
        class="add-confession-btn"
        [disabled]="!isValidConfession()"
        (click)="addConfession()">
        <ion-icon name="add-circle" slot="start"></ion-icon>
        Adicionar Confiss√£o
      </ion-button>
    </div>

    <!-- Current Player Confessions -->
    <div class="confessions-list-section" *ngIf="currentPlayerConfessions.length > 0">
      <h3 class="list-title">Suas Confiss√µes ({{ currentPlayerConfessions.length }})</h3>
      
      <div class="confessions-list">
        <div 
          *ngFor="let confession of currentPlayerConfessions; let i = index"
          class="confession-item">
          <div class="confession-header">
            <span class="confession-category">
              {{ getCategoryEmoji(confession.category) }} {{ confession.category }}
            </span>
            <ion-button 
              fill="clear" 
              size="small"
              class="delete-btn"
              (click)="removeConfession(confession.id)">
              <ion-icon name="trash-outline" slot="icon-only"></ion-icon>
            </ion-button>
          </div>
          <div class="confession-text">{{ confession.text }}</div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="currentPlayerConfessions.length === 0">
      <div class="empty-icon">‚úçÔ∏è</div>
      <h3>Primeira confiss√£o</h3>
      <p>Escreva algo interessante sobre voc√™</p>
    </div>
  </div>

  <!-- Toast de erro -->
  <ion-toast
    [isOpen]="showErrorToast"
    [message]="errorMessage"
    duration="3000"
    color="danger"
    position="top"
    (didDismiss)="showErrorToast = false">
  </ion-toast>
</ion-content>